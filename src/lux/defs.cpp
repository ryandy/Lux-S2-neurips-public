#include "lux/defs.hpp"

#include <sys/time.h>  // gettimeofday

#include <vector>
using namespace std;


vector<double> prandom_vals{ 0.5006206379487761, 0.5367561539308454, 0.5104555843345361, 0.7519122782767512, 0.22297886922554022, 0.6581177060884397, 0.7727665713548248, 0.7522428489849549, 0.03282505289271098, 0.7159931861084108, 0.7319827048773813, 0.3505301452868589, 0.2907964099298421, 0.1188348661706028, 0.3415444912934391, 0.1011533817074135, 0.6973307260069387, 0.03232775103233376, 0.7804725714269029, 0.7825904952245399, 0.4013296797535203, 0.05052126446733518, 0.35507169273698136, 0.3921072224310712, 0.954519866739726, 0.6646997223596254, 0.8518154324318393, 0.4888501250529165, 0.1462391648831416, 0.6865439893988656, 0.9198070434501978, 0.5818886957677382, 0.44174492540507515, 0.8268275995336971, 0.8666700379970469, 0.883466637133026, 0.5455780054715477, 0.7681537691747125, 0.6825760280314318, 0.6311397433086626, 0.44418065770151927, 0.8877002035468713, 0.73673076624235, 0.6373450218627197, 0.7551136739282526, 0.05804069189957639, 0.7142979697400234, 0.9838319552130625, 0.3345872080914464, 0.4576272970149272, 0.5327454301900781, 0.55834955452722, 0.958452509267672, 0.38452195739280015, 0.5567978660703035, 0.13199455991030418, 0.2023830107901572, 0.21375734887343656, 0.310290178846533, 0.06735450810039056, 0.8184428812646405, 0.624611358892868, 0.09804804830415559, 0.7431632654583699, 0.6417311004693236, 0.13400950266941813, 0.7224432025756593, 0.7854221623485922, 0.8894226178963696, 0.036054950460504, 0.9469559188914329, 0.9988511402742022, 0.8666068378760156, 0.10868989672902174, 0.4084169051925478, 0.665712756842941, 0.26417802056465545, 0.38997909470690484, 0.3267140707689169, 0.5031892915100327, 0.6306805724411516, 0.061878434418080164, 0.14990880864797873, 0.2645141303419811, 0.8357566294212622, 0.7666786595306873, 0.06183923505477962, 0.3538627341410313, 0.4009482947701857, 0.9145257548606486, 0.5597931395362453, 0.7857364898372478, 0.0021539106328730684, 0.907279074929874, 0.02721026173132557, 0.5511509838910186, 0.8096897862133107, 0.6161963278554999, 0.6698969802124817, 0.8891367378137485, 0.07660730019901196, 0.4178695289194442, 0.5384154392451632, 0.5106026336666268, 0.6662496284045875, 0.5034288857289719, 0.729288340384427, 0.05345383880782395, 0.8996345927887247, 0.424957952397335, 0.0669027023368931, 0.08907264190856767, 0.06696934456651227, 0.19376144131016426, 0.20442141408581194, 0.28771764006517253, 0.3694094637698958, 0.7427314245057534, 0.5675134109257767, 0.786407165676285, 0.6126802879370703, 0.6592109097750467, 0.9489825045811532, 0.21863152826500232, 0.4042735065025663, 0.9704438413484547, 0.714663010908343, 0.4338331122004452, 0.7637924985470235, 0.16481323059876074, 0.5631427282127819, 0.0235607965529685, 0.23645672764354464, 0.6979972656741843, 0.9076544743669255, 0.7904084700933084, 0.7065444242918535, 0.2894874703235347, 0.5522737970407825, 0.21265837724661807, 0.6101554031501077, 0.9855239835953585, 0.3808825903409514, 0.28732894897276506, 0.7803029473220223, 0.2447052562806903, 0.16955284735193699, 0.26406910388796134, 0.5825814477922666, 0.21149911976883884, 0.5397691507239779, 0.1978797503751154, 0.31534940123069044, 0.9589768999883358, 0.10159212157256492, 0.5987654873278344, 0.007409035514363893, 0.8467366381959521, 0.2514824882537575, 0.8061349971447318, 0.5505212883697768, 0.9375409821995186, 0.03827659026879915, 0.10812408689819097, 0.24618362152607542, 0.32641272396441046, 0.5043742389312157, 0.5050903468720102, 0.8982697632888921, 0.06670461211658474, 0.5274009158542963, 0.05223953996400266, 0.7249564686489659, 0.2547811382589661, 0.8983619065995787, 0.6944675685778601, 0.381218820485405, 0.11694660866906192, 0.004666731481736464, 0.3762438236373965, 0.7825056802359763, 0.9756826743100452, 0.9774083541088308, 0.8395531249657715, 0.3483711613049164, 0.7967049515868424, 0.2077609880590794, 0.25104558350907635, 0.9109773669737765, 0.18157361115850934, 0.0776842842041221, 0.9579659985084472, 0.8911966934446895, 0.34176677264598676, 0.5744644590203598, 0.5783676063811747, 0.5986302546115556, 0.7981042207066525, 0.8747821220096389, 0.7707897246675671, 0.2635479878114618, 0.5729927402611649, 0.13122170912648945, 0.458619521468845, 0.4591431391556856, 0.5392871457329098, 0.40784896231065093, 0.0061926661225846225, 0.02463639507658011, 0.9517536311899666, 0.17265822699692268, 0.23173229374236437, 0.42732945210866313, 0.04951063926940047, 0.8998153704165966, 0.882369481334555, 0.2645526285262487, 0.9047153558085321, 0.43944200664736965, 0.10309247396861176, 0.9148955668373594, 0.7312192358693347, 0.8504256589992385, 0.6034997823236292, 0.12756073680980762, 0.7263443896618439, 0.26172021371889886, 0.6962415192951191, 0.24181405485089436, 0.2174218392977042, 0.9819779281259726, 0.9170986755570403, 0.7285723559044623, 0.005872807695001536, 0.42868641323070356, 0.22654503983867313, 0.9356433116319238, 0.7039407924332921, 0.11261231592337484, 0.8791511388305797, 0.5691142964706029, 0.5788220538270705, 0.16277868754014058, 0.19591630023958562, 0.030122394095814853, 0.04911742096373162, 0.8698976190224402, 0.39347784590117396, 0.8190616963767072, 0.10292756554180671, 0.5832612031328925, 0.4623015935869905, 0.25599855770129354, 0.6454912247887385, 0.3948065844589286, 0.9249082098656509, 0.954659425593975, 0.5268931284113085, 0.17289451802670175, 0.8612041586039022, 0.2315066311014773, 0.08590795871977386, 0.7733074512397363, 0.19417969428596893, 0.6541497004067266, 0.8034371503537208, 0.9000073192944259, 0.740820949839722, 0.5265707185064633, 0.8426152585126512, 0.9105774118096172, 0.9989069685779246, 0.37099699914121664, 0.5880613969541241, 0.8857012749556356, 0.6676496183444258, 0.035798554367403645, 0.3529935913070392, 0.8190662730988584, 0.3568773888035066, 0.8319858913995143, 0.6789577490590762, 0.8481454388693822, 0.39044885203246493, 0.4351006128800925, 0.7776101121934902, 0.5657295607568479, 0.17195283450949994, 0.9711129185019927, 0.7875583996008093, 0.8983497340610772, 0.039816961146383334, 0.9959311692170477, 0.2926378447917677, 0.5266901386829874, 0.14192647395259084, 0.020845180081461856, 0.752055962674311, 0.01882191866378924, 0.3467491218952975, 0.3481867770836238, 0.05575765142396649, 0.8937343754450279, 0.5917606929773312, 0.5379864851251781, 0.07147272293074569, 0.2467352191458524, 0.5739923343811637, 0.1637484781184021, 0.5022608670374024, 0.438985101136961, 0.11593532605046786, 0.5292273219306846, 0.38269223188900225, 0.1323119333381919, 0.19145444901040287, 0.5813616363354913, 0.3446859244898568, 0.5010667115642591, 0.008939215304390458, 0.0069425060585444065, 0.5830658325866922, 0.6900794638357551, 0.08576848923617097, 0.38929335916710206, 0.08950821322910962, 0.8981431746877919, 0.6411895729033043, 0.15114946137622276, 0.10591738569522136, 0.8458021269153958, 0.3747420840311583, 0.7295686208815869, 0.8748311090492328, 0.10524390252617755, 0.9437632263869984, 0.7698546005126479, 0.04375647658253479, 0.1836621629612869, 0.36333060860037025, 0.5451533649061402, 0.20754637571283108, 0.1361568421186673, 0.20629874448739083, 0.1750671429278834, 0.17494168192139292, 0.0871931290132284, 0.6074642222236959, 0.9825211554840282, 0.38570606521999495, 0.5223809633549951, 0.9647635250091718, 0.15021468690359518, 0.20964932909515877, 0.555418304716166, 0.17981626249379434, 0.1944393728128483, 0.9164616192543038, 0.41785347422630725, 0.035861137546755684, 0.5491764914388731, 0.02640250261247734, 0.05163410911207489, 0.3416401951563177, 0.0637567286296199, 0.05673366845822225, 0.8510064066725026, 0.1361200078926179, 0.6947256788415196, 0.2515042189184121, 0.4065575948912059, 0.14385926540998706, 0.19005380384605886, 0.6766557052974715, 0.9826078061819842, 0.9802733407007579, 0.0816843438854068, 0.9278955279950362, 0.09936425761852963, 0.5084939215466852, 0.029462327406880817, 0.23757806798991932, 0.9694384300876414, 0.7397137830359776, 0.49195481639213723, 0.3241309431257746, 0.6938255238188663, 0.7767809920036052, 0.2949341746200794, 0.7742865315965571, 0.6244154542199472, 0.5741529671463889, 0.3542740633200734, 0.7474811453183224, 0.630227283014678, 0.3584925636759013, 0.31804419925366045, 0.5085365123761536, 0.9344886466036213, 0.3629337375754542, 0.8921339618238746, 0.9497398802047009, 0.2160215000888559, 0.5441038516951814, 0.33592920483491684, 0.5827480199992904, 0.19559384489441123, 0.5978257980225987, 0.11276287647987049, 0.6530313265033998, 0.3689397395549978, 0.9514027382611575, 0.9937062065819504, 0.7583686321639934, 0.3574279516454182, 0.45950635915631666, 0.7215801951523743, 0.5014500003660489, 0.8627116709389918, 0.8201683553363361, 0.7318858618245857, 0.7164741384340607, 0.7598074252450873, 0.8881716414619328, 0.8615959784035193, 0.3504751850828798, 0.29421055505029203, 0.37286463349456866, 0.9201915699280813, 0.959527896145937, 0.26764189943088623, 0.6721784321318097, 0.5493756828323653, 0.42749134085152063, 0.6194391950124913, 0.8536599449735185, 0.9786688420840344, 0.20348410985214005, 0.006729016728313608, 0.9359687251581976, 0.6196822315324484, 0.8803942018847579, 0.9386645834624688, 0.024876937669370935, 0.029717912012989345, 0.47549780987122225, 0.8267228433181157, 0.19487383435839534, 0.11500894229424119, 0.07190952843431009, 0.09819204966263406, 0.03967562224688892, 0.2353377295598772, 0.9302152981818588, 0.350541012160159, 0.8870882608432704, 0.3246784640289422, 0.08041327230806461, 0.23441200044815702, 0.9733691374920238, 0.6997721425516571, 0.628936078300858, 0.13965464969917196, 0.0553023349159526, 0.08348048348236714, 0.6329413037471724, 0.7487122312622444, 0.5092482403449817, 0.5944967606119731, 0.39226485566081715, 0.5201187717848297, 0.27755702191716114, 0.6848492398619284, 0.748092322465243, 0.9525961891337208, 0.338524017799281, 0.12353336191397402, 0.2187133760324358, 0.13081077030467647, 0.5764321042231804, 0.7866237511413666, 0.10766996507443982, 0.07182102261733003, 0.8470943016435611, 0.9166617253233963, 0.1279804635541839, 0.7528763998485479, 0.8178716261864105, 0.6238485848500325, 0.6231251205003218, 0.4079721778233423, 0.3170061495895643, 0.5323978373489006, 0.8542757361119382, 0.9687685937148254, 0.46530578060886074, 0.18702619575914103, 0.6978868096310394, 0.7509856420809649, 0.0328855389784003, 0.26854501459639357, 0.6868378871323085, 0.528210327048245, 0.1827618930274183, 0.10685698092391183, 0.5020788139818537, 0.12454036391621581, 0.0539069183997849, 0.46513062060435295, 0.28537206174097507, 0.5071817843344982, 0.4205054263126343, 0.3792286936246856, 0.6994655287397749, 0.274533754838856, 0.19661180444893456, 0.47676191870994755, 0.2318886303153046, 0.8060181793834601, 0.8976148223411352, 0.299356577690467, 0.15387079723610664, 0.6570751067020266, 0.35114919301678604, 0.775294980434759, 0.15604150170261288, 0.3688678859156501, 0.5681557374245544, 0.16400067652862094, 0.21551115937071064, 0.30054225072367136, 0.0400410507544432, 0.1165661324428644, 0.7034313275326359, 0.5460871377392255, 0.921978438453533, 0.7884521097129286, 0.2886470747048798, 0.9009335856293557, 0.8579611873041149, 0.8656640667292874, 0.9538172479622643, 0.40801291182719224, 0.15689856161629556, 0.14044483809026997, 0.23585393938450228, 0.6673129883026702, 0.08767021858061952, 0.5655815146658082, 0.29578871527710093, 0.7473808278283873, 0.7563521007506188, 0.7287126290344552, 0.8014082868044143, 0.7595761070955054, 0.11303542023399926, 0.5849491353452452, 0.508347320438909, 0.5579948382925523, 0.7979984329750636, 0.32882340718894276, 0.735180731644115, 0.8274611859918672, 0.9189855238647505, 0.4007053530770385, 0.6415439375842634, 0.5539619629356987, 0.8988020460661419, 0.48837388442701435, 0.8534669910986892, 0.8647081934039378, 0.9486138936009306, 0.22737864945693365, 0.6714121716224315, 0.17554984845251087, 0.31649386417823666, 0.16108061104102545, 0.23992587776588037, 0.5949432971057607, 0.5104174153758968, 0.6176762476039287, 0.8702241345294724, 0.5126657577676123, 0.3714223474225947, 0.15633365800425758, 0.5329205255560215, 0.8129198280649923, 0.2716313508382876, 0.44909842225604146, 0.2513504632425575, 0.16138101286094042, 0.7705501796972963, 0.17207991059063021, 0.8289397880267523, 0.5088844304553474, 0.7332595493324053, 0.4701343404675524, 0.042438751681736386, 0.6218970033639843, 0.29764512550200706, 0.8080720005217742, 0.40813283510070897, 0.33575014269525194, 0.24504629803073819, 0.4270191346432355, 0.9800962781895299, 0.6431782781751986, 0.7150942572662259, 0.341987850273372, 0.028891310450828933, 0.14027310589937003, 0.6482643007127611, 0.21680077980939116, 0.1848448127645691, 0.5363270300037988, 0.8299215458725681, 0.20116929491711932, 0.7494324447143702, 0.7751882234829011, 0.9919628630368627, 0.1135292736240372, 0.5692771557975498, 0.7398939856408032, 0.08944306986850359, 0.01666532453383074, 0.6829139228670005, 0.4578460436166133, 0.7698805796541329, 0.12363136583366185, 0.1896855715406125, 0.6818289183863261, 0.42092015182085296, 0.5712425530180112, 0.766339490908898, 0.019339648843465507, 0.2788493472197978, 0.8974871959520079, 0.3471046981119741, 0.8031141216329185, 0.5822534566532249, 0.14365589802569034, 0.8856471716891365, 0.8578630468647962, 0.9118351912319536, 0.24513764071570665, 0.04051034114431018, 0.9090130728060906, 0.14791437705939847, 0.19862869036028996, 0.661541068717161, 0.695387045059095, 0.610927511209227, 0.7668811217188424, 0.7785726292608343, 0.272058998583949, 0.17009754533090515, 0.1333740959199189, 0.38339440254721746, 0.9815193247252775, 0.5367354064487434, 0.04044943479253382, 0.9594006086315208, 0.3607220792567014, 0.44542016399745776, 0.08844897000517982, 0.4018855840012563, 0.6074286492739024, 0.5543313193600748, 0.5187942807289432, 0.8299375547306582, 0.757377525783338, 0.49915593042710193, 0.43324157640100114, 0.5355074948711924, 0.5864504881771149, 0.8032930451415243, 0.6892794502547855, 0.5920447210540343, 0.7041296472419218, 0.4384732759403276, 0.7130798420320938, 0.19246755404687366, 0.08388153201824666, 0.8623332184925765, 0.5063471332670899, 0.03113974847120149, 0.9571508718757217, 0.21277905073367842, 0.8023133989708197, 0.5586783854838708, 0.30686689807560663, 0.2259177177464009, 0.30691402301611215, 0.06898545166391157, 0.46391034007671306, 0.314131272381453, 0.2880315400161273, 0.7810563251272427, 0.9839417763406874, 0.7515300440743461, 0.8888023543360052, 0.9849998508326141, 0.22254992848881294, 0.3663469168023685, 0.29155874026125284, 0.22165431262004698, 0.5853465747050048, 0.3879661644797173, 0.2643752888829656, 0.9057778042032417, 0.13534858683181805, 0.9201685224384492, 0.18331560075875986, 0.47333599742088495, 0.5565424054690037, 0.5118045618705332, 0.009355283175617513, 0.5837172829834557, 0.813509884126107, 0.39380532706431237, 0.16238328529335333, 0.08070041047414644, 0.27074205509696936, 0.5582264960820744, 0.4162270926278079, 0.052097774236250394, 0.7084489755088776, 0.0841484859526006, 0.7870699944143991, 0.970197732938432, 0.5214477464433215, 0.4205388935915023, 0.904635939834861, 0.4835221151958694, 0.25518108139499474, 0.28582286099691345, 0.4330365081672892, 0.027487753374589752, 0.9362254580558035, 0.9618789725229481, 0.21294987583069214, 0.9429403120040575, 0.21871320921601933, 0.24618862255430352, 0.33045370845799404, 0.6652764397572315, 0.3106565588781488, 0.12552971178210004, 0.1602596107817289, 0.8574569582920104, 0.5768230297920767, 0.012537306598216835, 0.298272069375782, 0.6797153269861517, 0.8792341822077121, 0.8811577606391837, 0.01694540129307809, 0.2842309013507237, 0.9854098340507859, 0.8992037890025578, 0.993353272549904, 0.9520101950135151, 0.9808760377488618, 0.17997093085220794, 0.03095312199063971, 0.31861553574266843, 0.6049920579872837, 0.592289124162155, 0.39191325400634547, 0.9787575594772798, 0.8832734011627373, 0.6057027963021192, 0.09953005077995203, 0.2773614957353434, 0.04858500661492571, 0.4665524062670894, 0.5431803687039561, 0.3405043642737893, 0.8647154017915804, 0.3535796808799687, 0.6139324432832082, 0.4770573210875352, 0.0018542135870147636, 0.6100404106936882, 0.15782636787772997, 0.3456928898647691, 0.0948715545577582, 0.8168722687289022, 0.5778526891194102, 0.9751333872792292, 0.19171418088867043, 0.46302772219801536, 0.3167024553987453, 0.31198753080455965, 0.31164425772771787, 0.5040212527426187, 0.8021549140058714, 0.6758271952284084, 0.05012590726662258, 0.10666840525696497, 0.1897437689180259, 0.21160496908063475, 0.5808890357039632, 0.15097228127886597, 0.20266778358196158, 0.7255813948485269, 0.7618989296428222, 0.26202465374242034, 0.11963372241846304, 0.7608823422702754, 0.06447129811223329, 0.2333423226620892, 0.4695582536944435, 0.6050468805466919, 0.19266440474955293, 0.20464430719975424, 0.5451039538371756, 0.029031335563810323, 0.5231168852823614, 0.7969499239308417, 0.7296337162534902, 0.3066189163562645, 0.9252011678797734, 0.11666167793967419, 0.6834004736798732, 0.9854971675544766, 0.8550501746579802, 0.8158965600052268, 0.8952096729980619, 0.6983021842152561, 0.002517292797920345, 0.715532624106985, 0.3964863574264649, 0.10954999484804073, 0.02558830560281178, 0.38663289204106244, 0.9020791417364288, 0.2537525477541359, 0.39224854618752847, 0.3558218965464306, 0.44230631062499703, 0.3108423126921931, 0.5194119075827391, 0.3908638617609512, 0.8322792447347326, 0.059156308363455756, 0.03414614581302777, 0.6927011331142869, 0.476064714922913, 0.33718534336666384, 0.9824635859023432, 0.26999772874792793, 0.9327663495742917, 0.5960425457791441, 0.15705066712738391, 0.7529390226390027, 0.9944327062067778, 0.25265866294191464, 0.8805155193244631, 0.7798873158912443, 0.7857677204211411, 0.5291837786104284, 0.4162160922928272, 0.38889453979919575, 0.082587433798047, 0.6991965225591183, 0.3802081587126782, 0.9105583915077483, 0.3112417988253242, 0.962086790323404, 0.7057532193817023, 0.8225742240591645, 0.20092265319403857, 0.15856961479906273, 0.4654579040057524, 0.3511406851470815, 0.3731775173377285, 0.946208576530868, 0.4125358930128048, 0.6451987684046888, 0.35800896300689855, 0.04320615178733134, 0.4249412499648271, 0.7533711184982504, 0.2815851281315833, 0.9977510058108275, 0.9329956353271234, 0.8624166504923272, 0.05824943111547909, 0.4199547501989622, 0.9520900722779624, 0.3906440963917026, 0.28753413395591243, 0.6669701862588837, 0.39803028435116883, 0.9120563918639096, 0.32561312814937793, 0.1264616307577291, 0.4871846930541611, 0.15835031139578193, 0.8316612019776092, 0.9325156505678921, 0.33824137500206397, 0.5070811741144852, 0.8927683446058187, 0.7150041048406044, 0.7027850683056692, 0.8783282711984969, 0.5540450537810345, 0.19465625991881974, 0.9770093718382831, 0.3425172856494131, 0.42729995355421924, 0.015955366067115118, 0.5968634458600384, 0.19048021470610133, 0.7025734114135767, 0.5544304364619772, 0.8793004949594804, 0.944019457959356, 0.3195789702860735, 0.8669815260728795, 0.4035416537176634, 0.6358677644967592, 0.8310181352606445, 0.5364255676101506, 0.5581005189074593, 0.8655334346364587, 0.9647330727544189, 0.7916898226681964, 0.23104021887443393, 0.24840572544677608, 0.8679988444633105, 0.38301828703985785, 0.29545787072511664, 0.2678192677727739, 0.0027646064702904205, 0.8239829328235929, 0.1665163801839713, 0.15405687871873108, 0.1584288591111237, 0.8252253232431489, 0.2211810901222565, 0.20089596903574625, 0.05362272666472312, 0.2862894096463463, 0.12077057800569058, 0.1647575653687806, 0.9043193777153699, 0.9800468246340976, 0.7459805675571015, 0.4502852824206536, 0.5510315475741743, 0.7336063824140839, 0.19453460095393071, 0.33619101672596774, 0.6150717238858792, 0.44575324836441554, 0.7579361125661745, 0.9273395980828522, 0.24432657686018144, 0.6669456452281385, 0.794628596388355, 0.7124230298845476, 0.7098273142967009, 0.014694573496254137, 0.04380280729018471, 0.7801938990507744, 0.64007540222617, 0.7605885184117565, 0.4447940479199207, 0.5074926065550671, 0.2715034982798147, 0.024853695340357862, 0.17983714579405186, 0.09200371053422851, 0.5971674733439599, 0.5622680849911824, 0.6820986774451534, 0.3643719248623941, 0.384958379690272, 0.9198823632616456, 0.7792293675040278, 0.38329664658343177, 0.4471673038783244, 0.665572309191122, 0.8812076061680025, 0.30734734572369127, 0.5327521054231542, 0.2629042356302951, 0.40887356377712547, 0.8371863590030703, 0.9417954485343477, 0.3093333592540346, 0.024720515108261787, 0.6077580688936077, 0.2914646691984891, 0.7038382094853448, 0.5448885227695662, 0.9483553731766848 };

double get_time() {
    timeval tv;
    gettimeofday(&tv, NULL);
    return tv.tv_sec + tv.tv_usec * 1e-6;
}

bool prandom(int seed, double percent_chance) {
    return prandom_vals[seed % prandom_vals.size()] < percent_chance;
}

int prandom_index(int seed, int len) {
    return len * prandom_vals[seed % prandom_vals.size()];
}
